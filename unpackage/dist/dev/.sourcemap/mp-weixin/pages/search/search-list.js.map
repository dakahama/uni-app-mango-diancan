{"version":3,"sources":["webpack:///D:/Workspance/HBuilderProjects/uni-app-mango-diancan/main.js","webpack:///D:/Workspance/HBuilderProjects/uni-app-mango-diancan/pages/search/search-list.vue?e557","webpack:///D:/Workspance/HBuilderProjects/uni-app-mango-diancan/pages/search/search-list.vue?37d4","webpack:///D:/Workspance/HBuilderProjects/uni-app-mango-diancan/pages/search/search-list.vue?e345","webpack:///D:/Workspance/HBuilderProjects/uni-app-mango-diancan/pages/search/search-list.vue?410b","webpack:///D:/Workspance/HBuilderProjects/uni-app-mango-diancan/pages/search/search-list.vue"],"names":["createPage","Page","components","searchList","noThing","uniDrawer","zcmRadioGroup","data","loadtext","keyword","page","limit","list","screen","currentIndex","name","status","key","label","selected","rule","value","showRigth","condition","oldSelected","computed","options","obj","onNavigationBarSearchInputChanged","e","text","onNavigationBarSearchInputConfirmed","initSearch","search","onNavigationBarButtonTap","onLoad","getData","onPullDownRefresh","uni","showToast","title","icon","stopPullDownRefresh","onReachBottom","beforeDestroy","methods","hideKeyboard","addHistory","history","getStorageSync","JSON","parse","index","indexOf","unshift","splice","setStorageSync","stringify","refresh","callback","$H","post","then","res","format","length","console","log","map","item","goodNums","num","id","cover","desci","price","toFixed","changeScreen","oldIndex","oldItem","newIitem","confirm","getCondition","reset"],"mappings":"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","file":"pages/search/search-list.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'\nimport Page from './pages/search/search-list.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./search-list.vue?vue&type=template&id=b67bbaac&\"\nvar renderjs\nimport script from \"./search-list.vue?vue&type=script&lang=js&\"\nexport * from \"./search-list.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('b67bbaac')) {\n      api.createRecord('b67bbaac', component.options)\n    } else {\n      api.reload('b67bbaac', component.options)\n    }\n    module.hot.accept(\"./search-list.vue?vue&type=template&id=b67bbaac&\", function () {\n      api.rerender('b67bbaac', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Workspance/HBuilderProjects/uni-app-mango-diancan/pages/search/search-list.vue\"\nexport default component.exports","export * from \"-!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search-list.vue?vue&type=template&id=b67bbaac&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.showRigth = true\n    }\n\n    _vm.e1 = function($event) {\n      _vm.showRigth = false\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search-list.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./search-list.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport uniDrawer from \"@/components/uni-ui/uni-drawer/uni-drawer.vue\"\nimport zcmRadioGroup from \"@/components/common/radio-group.vue\"\nimport searchList from \"@/components/search/search-list.vue\"\nimport noThing from '@/components/common/no-thing.vue';\nexport default {\n\tcomponents: {\t\t\t\n\t\tsearchList,\n\t\tnoThing,\n\t\tuniDrawer,\n\t\tzcmRadioGroup\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t// 1.上拉加载更多  2.加载中... 3.没有更多了\n\t\t\tloadtext:\"上拉加载更多\",\n\t\t\tkeyword:\"\",\n\t\t\tpage:1,\n\t\t\tlimit:5,\n\t\t\tlist:[],\n\t\t\tscreen:{\n\t\t\t\tcurrentIndex:0,\n\t\t\t\tlist:[\n\t\t\t\t\t// status 0 1升序 2 降序\n\t\t\t\t\t{ name:\"综合\",status:1,key:\"all\" },\n\t\t\t\t\t{ name:\"销量\",status:0,key:\"sale_count\" },\n\t\t\t\t\t{ name:\"价格\",status:0,key:\"min_price\" },\n\t\t\t\t]\n\t\t\t},\n\t\t\tlabel:{\n\t\t\t\tselected:0,\n\t\t\t\tlist:[\n\t\t\t\t\t{name:\"不限\",rule:false,value:false},\n\t\t\t\t\t{name:\"0-5\",rule:\"between\",value:\"0,5\"},\n\t\t\t\t\t{name:\"5-10\",rule:\"between\",value:\"5,10\"},\n\t\t\t\t\t{name:\"10-50\",rule:\"between\",value:\"10,50\"},\n\t\t\t\t\t{name:\"50-100\",rule:\"between\",value:\"50,100\"},\n\t\t\t\t\t{name:\"大于100\",rule:\">\",value:\"100\"},\n\t\t\t\t]\n\t\t\t},\n\t\t\tshowRigth:false,\n\t\t\tcondition:{},\n\t\t\toldSelected:0,\n\t\t}\n\t},\n\tcomputed: {\n\t\t// 排序相关\n\t\toptions() {\n\t\t\tlet obj = this.screen.list[this.screen.currentIndex]\n\t\t\tlet value = obj.status === 1 ? 'asc' : 'desc'\n\t\t\treturn {\n\t\t\t\t[obj.key]:value\n\t\t\t}\n\t\t},\n\t},\n\tonNavigationBarSearchInputChanged(e) {\n\t\tthis.keyword = e.text\n\t},\n\tonNavigationBarSearchInputConfirmed() {\n\t\tthis.initSearch()\n\t\tthis.search()\n\t},\n\tonNavigationBarButtonTap() {\n\t\tthis.initSearch()\n\t\tthis.search()\n\t},\n\tonLoad(e) {\n\t\tthis.keyword = e.keyword\n\t\t// 加载数据\n\t\tthis.getData()\n\t},\n\tonPullDownRefresh() {\n\t\tthis.getData(true,()=>{\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '刷新成功',\n\t\t\t\ticon:\"none\"\n\t\t\t});\n\t\t\tuni.stopPullDownRefresh()\n\t\t})\n\t},\n\tonReachBottom() {\n\t\t// 是否已经处于加载状态\n\t\tif (this.loadtext !== '上拉加载更多') return;\n\t\t// 改变加载状态\n\t\tthis.loadtext = '加载中...'\n\t\tthis.page++\n\t\t// 请求数据\n\t\tthis.getData(false)\n\t},\n\tbeforeDestroy() {\n\t\tthis.keyword = ''\n\t},\n\tmethods: {\n\t\t// 初始化搜索\n\t\tinitSearch(){\n\t\t\tthis.label.selected = 0\n\t\t\tthis.condition = {}\n\t\t\tthis.page = 1\n\t\t},\n\t\t// 搜索\n\t\tsearch(){\n\t\t\tif (this.keyword === '') {\n\t\t\t\treturn uni.showToast({\n\t\t\t\t\ttitle: '关键词不能为空',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t}\n\n\n\n\n\t\t\tuni.hideKeyboard()\n\n\t\t\t\n\t\t\tthis.addHistory()\n\t\t\tthis.initSearch()\t\n\t\t\tthis.list = []\n\t\t\t\n\t\t\tthis.getData()\n\t\t\t\t\n\t\t},\n\t\taddHistory(){\n\t\t\t// 拿到所有的搜索历史\n\t\t\tlet history = uni.getStorageSync('searchHistory')\n\t\t\thistory = history ? JSON.parse(history) : []\n\t\t\t// 判断之前是否有该搜索记录\n\t\t\tlet index = history.indexOf(this.keyword)\n\t\t\tif (index === -1) {\n\t\t\t\thistory.unshift(this.keyword)\n\t\t\t} else {\n\t\t\t\thistory.unshift(history.splice(index,1)[0])\n\t\t\t}\n\t\t\tuni.setStorageSync('searchHistory',JSON.stringify(history))\n\t\t},\n\t\t// 加载数据\n\t\tgetData(refresh = false, callback = false){\n\t\t\tlet page = refresh ? 1 : this.page\n\t\t\t\n\t\t\t//console.log(JSON.stringify(this.options))\n\t\t\t//console.log(JSON.stringify(this.condition))\n\t\t\t\n\t\t\tthis.$H.post('/product/product/search',{\n\t\t\t\ttitle:this.keyword,\n\t\t\t\tpage:page,\n\t\t\t\tlimit:this.limit,\n\t\t\t\t...this.options,\n\t\t\t\t...this.condition\n\t\t\t}).then(res=>{\n\t\t\t\t\n\t\t\t\t//this.keyword = \"\"\n\t\t\t\t\n\t\t\t\t//console.log(res)\n\t\t\t\tlet list = this.format(res.list)\n\t\t\t\tthis.list = refresh ? [...list]:[...this.list,...list]\n\t\t\t\t\n\t\t\t\t// 恢复加载状态\n\t\t\t\tthis.loadtext = res.list.length < this.limit ? '没有更多了' : '上拉加载更多'\n\t\t\t\tconsole.log(this.loadtext)\n\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\tcallback()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 格式化\n\t\tformat(res){\n\t\t\treturn res.map(item=>{\n\t\t\t\tvar goodNums = item.num === 0 ? 0 : (item.goodNums / item.num) * 100\n\t\t\t\treturn {\n\t\t\t\t\tid:item.id,\n\t\t\t\t\ttitle:item.title,\n\t\t\t\t\tcover:item.cover,\n\t\t\t\t\tdesci:item.desci,\n\t\t\t\t\tprice:item.price,\n\t\t\t\t\tnum:item.num,\n\t\t\t\t\tgoodNums:goodNums.toFixed(2) + '%'\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tchangeScreen(index){\n\t\t\tthis.page = 1\n\t\t\tthis.list = []\n\t\t\t// 判断当前点击是否已经是激活状态\n\t\t\tlet oldIndex = this.screen.currentIndex\n\t\t\tlet oldItem = this.screen.list[oldIndex]\n\t\t\tif (oldIndex === index) {\n\t\t\t\toldItem.status = oldItem.status === 1 ? 2 : 1\n\t\t\t\t// 加载数据\n\t\t\t\tthis.getData()\n\t\t\t\treturn\n\t\t\t}\n\t\t\tlet newIitem = this.screen.list[index] \n\t\t\t// 移除旧激活状态\n\t\t\toldItem.status = 0\n\t\t\tthis.screen.currentIndex = index\n\t\t\t// 增加新激活状态\n\t\t\tnewIitem.status = 1\n\t\t\t// 加载数据\n\t\t\t\n\t\t\tthis.getData()\n\t\t},\t\t\t\n\t\t// 提交筛选条件\n\t\tconfirm(){\n\t\t\tthis.page = 1\n\t\t\tthis.list = []\n\t\t\t// 组织筛选条件\n\t\t\tthis.getCondition()\n\t\t\t// 获取数据\n\t\t\tthis.getData()\n\t\t\t\n\t\t\tthis.showRigth = false\n\t\t},\n\t\t// 重置\n\t\treset(){\n\t\t\tthis.condition = {}\n\t\t\tthis.label.selected = 0\n\t\t\t// 获取数据\n\t\t\tthis.getData(true)\n\t\t\t\n\t\t},\n\t\t\n\t\t// 组织筛选条件\n\t\tgetCondition(){\n\t\t\tlet item = this.label.list[this.label.selected]\n\t\t\tthis.condition = (item.rule && item.value) ? {\n\t\t\t\tprice:item.rule+','+item.value\n\t\t\t} : {\n\t\t\t}\n\t\t}\n\t}\n}\n"],"sourceRoot":""}