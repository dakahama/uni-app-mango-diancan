(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order-confirm/order-confirm"],{2147:function(t,n,o){"use strict";var e,i=function(){var t=this,n=t.$createElement;t._self._c},r=[];o.d(n,"b",function(){return i}),o.d(n,"c",function(){return r}),o.d(n,"a",function(){return e})},4195:function(t,n,o){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=o("2f62");function i(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{},e=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.forEach(function(n){r(t,n,o[n])})}return t}function r(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}var u=function(){return o.e("components/uni-ui/uni-list-item/uni-list-item").then(o.bind(null,"c9df"))},c=function(){return o.e("components/common/price").then(o.bind(null,"d917"))},a={components:{uniListItem:u,price:c},data:function(){return{loading:!1,path:!1,items:[],couponCount:0,coupon:{id:0,type:0,value:0},order_id:0}},computed:i({},(0,e.mapState)({list:function(t){return t.cart.list}}),(0,e.mapGetters)(["defaultPath","totalPrice"]),{goodsList:function(){var t=this;return this.items.map(function(n){return t.list.find(function(t){return t.id===n})})},price:function(){return 0===this.coupon.id?this.totalPrice:0===this.coupon.type?this.totalPrice-this.coupon.value:(this.totalPrice*(this.coupon.value/10)).toFixed(2)}}),onLoad:function(n){var o=this;if(!n.detail)return t.showToast({title:"请选择要下单的商品",icon:"none"}),t.navigateBack({delta:1});this.items=JSON.parse(n.detail),this.defaultPath.length&&(this.path=this.defaultPath[0]),t.$on("choosePath",function(t){o.path=t}),t.$on("couponUser",function(t){o.coupon=t}),this.getCouponCount()},onUnload:function(){t.$off("choosePath"),t.$off("couponUser")},onShow:function(){this.order_id>0&&t.redirectTo({url:"../order-detail/order-detail?id="+this.order_id})},methods:{openPathList:function(){t.navigateTo({url:"../user-address/user-address?type=choose"})},openOrderInvoice:function(){t.navigateTo({url:"../order-invoice/order-invoice"})},openPayMethods:function(){var n=this;if(!this.loading){if(!this.path)return t.showToast({title:"请选择收货地址",icon:"none"});var o={user_addresses_id:this.path.id,items:this.items.join(",")};this.coupon.id>0&&(o.coupon_user_id=this.coupon.id),this.loading=!0,this.$H.post("/order",o,{token:!0}).then(function(o){n.loading=!1,t.navigateTo({url:"../pay-methods/pay-methods?detail="+JSON.stringify({id:o.id,price:o.total_price})}),n.order_id=o.id,t.$emit("updateCart")}).catch(function(o){n.loading=!1,console.log(o),t.showToast({title:"创建订单失败",icon:"none"})})}},openCoupon:function(){t.navigateTo({url:"../order-coupon/order-coupon?detail="+JSON.stringify({price:this.totalPrice})})},getCouponCount:function(){var n=this;this.$H.post("/coupon_count",{price:this.totalPrice},{token:!0}).then(function(t){n.couponCount=t}).catch(function(n){t.showToast({title:"获取可用优惠券数量失败",icon:"none"})})}}};n.default=a}).call(this,o("543d")["default"])},"5b96":function(t,n,o){"use strict";o.r(n);var e=o("2147"),i=o("8402");for(var r in i)"default"!==r&&function(t){o.d(n,t,function(){return i[t]})}(r);var u,c=o("f0c5"),a=Object(c["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],u);n["default"]=a.exports},8402:function(t,n,o){"use strict";o.r(n);var e=o("4195"),i=o.n(e);for(var r in e)"default"!==r&&function(t){o.d(n,t,function(){return e[t]})}(r);n["default"]=i.a},a557:function(t,n,o){"use strict";(function(t){o("1039"),o("921b");e(o("66fd"));var n=e(o("5b96"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,o("543d")["createPage"])}},[["a557","common/runtime","common/vendor"]]]);