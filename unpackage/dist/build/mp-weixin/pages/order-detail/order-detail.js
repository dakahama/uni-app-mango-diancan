(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order-detail/order-detail"],{1054:function(t,e,n){"use strict";(function(t){n("1039"),n("921b");i(n("66fd"));var e=i(n("ce33"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},a23f:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("dc4d"));function o(t){return t&&t.__esModule?t:{default:t}}var r=null,a=function(){return n.e("components/order/order-list-item").then(n.bind(null,"9a9f"))},s=function(){return n.e("components/uni-ui/uni-list-item/uni-list-item").then(n.bind(null,"c9df"))},u=function(){return n.e("components/common/price").then(n.bind(null,"d917"))},c=function(){return n.e("components/common/card").then(n.bind(null,"3249"))},d=function(){return n.e("components/common/common-button").then(n.bind(null,"2d10"))},l={components:{orderListItem:a,uniListItem:s,price:u,card:c,commonButton:d},data:function(){return{id:0,no:"",address:{province:"",city:"",district:"",address:"",zip:0,name:"",phone:""},total_price:0,remark:"",paid_time:null,payment_method:"",payment_no:"",refund_status:"pending",ship_status:"",extra:null,create_time:"",update_time:"",reviewed:0,order_items:[],couponUserItem:[],end_time:0,timeDown:""}},computed:{price:function(){var t=0;return this.order_items.forEach(function(e){t+=e.pprice*e.num}),t.toFixed(2)},path:function(){var t=this.address,e=t.province,n=t.city,i=t.district,o=t.address;return"".concat(e," ").concat(n," ").concat(i," ").concat(o)},status:function(){return this.$U.formatStatus({paid_time:this.paid_time,refund_status:this.refund_status,ship_status:this.ship_status})},coupon:function(){if(Array.isArray(this.couponUserItem)&&0===this.couponUserItem.length)return"未使用";var t=this.couponUserItem.coupon,e=t.type,n=t.value;return 0===e?"-￥"+n:"打"+n+"折"},timeDownText:function(){var t="";switch(this.status){case"待支付":t="取消";break;case"待收货":t="确认";break;case"待发货":return"等待商家发货";case"退款中":return"等待商家审核";case"已签收":return"订单已签收"}return""!==t&&""!==this.timeDown?"还差 ".concat(this.timeDown," 自动").concat(t):""}},onLoad:function(e){if(!e.id)return t.showToast({title:"订单不存在",icon:"none"}),t.navigateBack({delta:1});this.id=e.id},onUnload:function(){r&&clearInterval(r)},onShow:function(){this.getData()},methods:{openTimeDown:function(){var e=this;"待支付"!==this.status&&"待收货"!==this.status||(r&&clearInterval(r),r=setInterval(function(){var n=(new Date).getTime()/1e3;if(n>e.end_time)return t.switchTab({url:"../index/index"}),t.showToast({title:"待支付"===e.status?"订单已关闭":"订单已确认",icon:"none"}),e.timeDown="",clearInterval(r);e.timeDown=i.default.timeDown(e.end_time)},1e3))},getData:function(){var t=this;this.$H.get("/order/"+this.id,{},{token:!0}).then(function(e){console.log(e),t.end_time=e.end_time?e.end_time:0,t.no=e.no,t.address=e.address,t.total_price=e.total_price,t.remark=e.remark,t.paid_time=e.paid_time,t.payment_method=e.payment_method,t.payment_no=e.payment_no,t.refund_status=e.refund_status,t.ship_status=e.ship_status,t.extra=e.extra,t.create_time=e.create_time,t.update_time=e.update_time,t.reviewed=e.reviewed;var n=e.orderItems.map(function(t){var e=[];if(1===t.skus_type&&t.goodsSkus&&t.goodsSkus.skus){var n=t.goodsSkus.skus;for(var i in n)e.push(n[i].value)}return{id:t.goods_id,cover:t.goodsItem.cover,title:t.goodsItem.title,pprice:t.price,attrs:e.join(","),num:t.num}});t.openTimeDown(),t.order_items=n,t.couponUserItem=e.couponUserItem})},openPayMethods:function(){t.navigateTo({url:"/pages/pay-methods/pay-methods?detail="+JSON.stringify({id:this.id,price:this.total_price})})},closeOrder:function(){var e=this;t.showModal({content:"是否要取消该订单？",success:function(n){n.confirm&&(t.showLoading({title:"取消订单中...",mask:!1}),e.$H.post("/closeorder/"+e.id,{},{token:!0}).then(function(e){t.hideLoading(),t.navigateBack({delta:1}),t.showToast({title:"取消订单成功",icon:"none"})}).catch(function(e){t.hideLoading()}))}})},applyRefund:function(){t.navigateTo({url:"/pages/order-refund/order-refund?detail="+JSON.stringify({id:this.id})})},openLogistics:function(){t.navigateTo({url:"/pages/logistics-detail/logistics-detail?detail="+JSON.stringify({id:this.id})})},received:function(){var e=this;t.showModal({content:"是否要确认收货？",success:function(n){n.confirm&&(t.showLoading({title:"确认收货中...",mask:!1}),e.$H.post("/order/"+e.id+"/received",{},{token:!0}).then(function(e){t.hideLoading(),t.navigateBack({delta:1}),t.showToast({title:"确认收货成功",icon:"none"})}).catch(function(e){t.hideLoading()}))}})}}};e.default=l}).call(this,n("543d")["default"])},ce33:function(t,e,n){"use strict";n.r(e);var i=n("fc1d"),o=n("f7f1");for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);var a,s=n("f0c5"),u=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=u.exports},f7f1:function(t,e,n){"use strict";n.r(e);var i=n("a23f"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e["default"]=o.a},fc1d:function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return i})}},[["1054","common/runtime","common/vendor"]]]);